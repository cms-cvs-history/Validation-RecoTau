process TEST = {

    service = DaqMonitorROOTBackEnd{ }

    untracked PSet maxEvents = {untracked int32 input = 45000}

    source = PoolSource {
	untracked vstring fileNames = {
	    '/store/RelVal/2007/9/15/RelVal-RelValZ-TT-1189882680/0002/0204DEAB-0965-DC11-AF43-000423D98E54.root'
	}
	untracked uint32 debugVebosity = 0
	untracked bool   debugFlag     = true
    }
# service = AdaptorConfig {}    
# Message Logger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
#    replace MessageLogger.cout.threshold = "INFO"


    include "Validation/RecoTau/test/Z2Tau_castor.cff"

  include "RecoParticleFlow/Configuration/data/RecoParticleFlow.cff"
  
  

  # Magnetic Field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # Geometry
  include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
       


//Aggiungere TauJetMC Filter
module tauHadrFilter = TauJetMCFilter{
        InputTag GenParticles = source
        double EtTau = 0.0
        double EtaTauMin = 0.0
        double EtaTauMax = 2.5
        double EtaElecMax=2.5
        double EtaMuonMax=2.5
        double PtElec =0.
        double PtMuon=0.
        vstring includeList ={"tautau"}
#        vstring includeList ={"etau"}
#        vstring includeList ={"mutau"}
}

  
    
     module ConeIsolationForValidation = ConeIsolation {	
        string JetTrackSrc = "jetTracksAssociator"
        string vertexSrc = "offlinePrimaryVerticesFromCTFTracks"
        int32 MinimumNumberOfPixelHits = 2
        int32 MinimumNumberOfHits = 8
        double MaximumTransverseImpactParameter = 0.03
        double MinimumTransverseMomentum = 1.
        double MaximumChiSquared = 100
        double MatchingCone = 0.1
        double  SignalCone = 0.1
        double  IsolationCone = 0.5
        double MinimumTransverseMomentumInIsolationRing = 1.
        double MinimumTransverseMomentumLeadingTrack = 5.
        double DeltaZetTrackVertex = 0.2
        int32   MaximumNumberOfTracksIsolationRing = 0
        bool useVertex =false
        #string vertexSrc = "offlinePrimaryVerticesFromCTFTracks"

	bool UseFixedSizeCone = true
	double VariableConeParameter = 3.5
	double VariableMaxCone = 0.17
	double VariableMinCone = 0.05
	
    }


#Ecal Isolation
module jetCrystalsAssociator = JetCrystalsAssociator {
    InputTag EBRecHits =ecalRecHit:EcalRecHitsEB 
    InputTag EERecHits =ecalRecHit:EcalRecHitsEE 
      InputTag jets   = iterativeCone5CaloJets      
      double coneSize = 0.5
}

module ecalIsolation = EcalIsolation{
        InputTag JetForFilter = jetCrystalsAssociator 
	double SmallCone = 0.15
        double BigCone   = 0.5
        double Pisol = 5.0
}


    module tauTagTestForIsoEffValid = TauTagVal{
	string DataType = "TAU" 
#Could be either TAU or QCD
	InputTag GenJetProd = iterativeCone5GenJets
	InputTag JetTagProd = ConeIsolationForValidation 
	InputTag JetEMTagProd = ecalIsolation
	string OutPutFile = "tautag_IsoEffValid_Z2Tau.root"
	double SignalCone = 0.1
	double MatchingCone = 0.1
        double IsolationCone = 0.5 
	double MinimumTransverseMomentumLeadingTrack = 5.
	double 	MinimumTransverseMomentumInIsolationRing = 1.
        int32   MaximumNumberOfTracksIsolationRing = 0	
    }
     # For Isolation Cone Eff Valid	
     path p1={tauHadrFilter,jetCrystalsAssociator,ecalIsolation,ConeIsolationForValidation,tauTagTestForIsoEffValid}

}
