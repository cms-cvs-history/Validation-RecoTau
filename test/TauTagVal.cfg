process TEST = {

    service = DaqMonitorROOTBackEnd{ }

    source = PoolSource {
	untracked vstring fileNames = { 	
           'file:/afs/cern.ch/cms/Tutorials/july06/BTauReconstruction/TauSample_1_0_1/tauReco.root'            
#'rfio:/castor/cern.ch/cms/T0/wildish/CSA06-102-os-Jets-0/RECO/CMSSW_1_0_2-RECO-H2547c9310a47f12fe7f1c67503ec5e43/1007/FE59094C-7A55-DB11-BBF8-0002B3D8E804.root',
#'rfio:/castor/cern.ch/cms/T0/wildish/CSA06-102-os-Jets-0/RECO/CMSSW_1_0_2-RECO-H2547c9310a47f12fe7f1c67503ec5e43/1007/E218B542-7B55-DB11-8FAC-0002B3D8BE20.root',
#'rfio:/castor/cern.ch/cms/T0/wildish/CSA06-102-os-Jets-0/RECO/CMSSW_1_0_2-RECO-H2547c9310a47f12fe7f1c67503ec5e43/1007/F8859336-7B55-DB11-B1B5-0002B3D8C248.root'        
}
	untracked int32 maxEvents = 10
	untracked uint32 debugVebosity = 0
	untracked bool   debugFlag     = true
    }
 service = AdaptorConfig {}    
    # Message Logger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    replace MessageLogger.cout.threshold = "INFO"

    include "RecoVertex/PrimaryVertexProducer/data/OfflinePrimaryVerticesFromCTFTracks.cff"
    #Pixel Vertexing

    include "RecoPixelVertexing/PixelVertexFinding/data/PixelVertexes.cfi"
    replace pixelVertices.NTrkMin = 2
    
    
    # Test tracks to jets association
    module jetTrackAssociations = JetTracksAssociator {
	InputTag tracks = ctfWithMaterialTracks
	InputTag jets   = iterativeCone5CaloJets
	double coneSize = 0.5
    }
    module coneIsolationWithPxlVertex = coneIsolationTauJetTags from "RecoTauTag/ConeIsolation/data/coneIsolationTauJetTags.cfi"
    replace coneIsolationWithPxlVertex.JetTrackSrc = "jetTrackAssociations"
    replace coneIsolationWithPxlVertex.vertexSrc = "pixelVertices"
    replace coneIsolationWithPxlVertex.DeltaZetTrackVertex = 0.2
    replace coneIsolationWithPxlVertex.useVertex = true	

    
    module coneIsolationWithVertex = coneIsolationTauJetTags from "RecoTauTag/ConeIsolation/data/coneIsolationTauJetTags.cfi"
    replace coneIsolationWithVertex.JetTrackSrc = "jetTrackAssociations"
    replace coneIsolationWithVertex.DeltaZetTrackVertex = 0.2
    replace coneIsolationWithVertex.useVertex = true	
    
    module coneIsolationWithoutVertex = coneIsolationTauJetTags from "RecoTauTag/ConeIsolation/data/coneIsolationTauJetTags.cfi"
    replace coneIsolationWithoutVertex.JetTrackSrc = "jetTrackAssociations"
    replace coneIsolationWithoutVertex.DeltaZetTrackVertex = 0.2
    replace coneIsolationWithoutVertex.useVertex = false


    module tauTagTestPxlVertex = TauTagVal{
	InputTag JetTagProd = coneIsolationWithPxlVertex
	string OutPutFile = "tautag_PxlVertex.root"
	double SignalCone = 0.07
	double MatchingCone = 0.1
        double IsolationCone = 0.45 
	double MinimumTransverseMomentumLeadingTrack = 6.	
    }

    module tauTagTestVertex = TauTagVal{
	InputTag JetTagProd = coneIsolationWithVertex

	string OutPutFile = "tautag_Vertex.root"
	double SignalCone = 0.07
	double MatchingCone = 0.1
        double IsolationCone = 0.45 
	double MinimumTransverseMomentumLeadingTrack = 6.	
    }
    
    module tauTagTestNoVertex = TauTagVal{
	InputTag JetTagProd = coneIsolationWithoutVertex
	string OutPutFile = "tautag_NoVertex.root"
	double SignalCone = 0.07
	double MatchingCone = 0.1
        double IsolationCone = 0.45 
	double MinimumTransverseMomentumLeadingTrack = 6.	
    }
    
    # module execution
#    path p = {offlinePrimaryVerticesFromCTFTracks&jetTrackAssociations, coneIsolationWithoutVertex, tauTagTestNoVertex  }

    path p1 = {offlinePrimaryVerticesFromCTFTracks&jetTrackAssociations, coneIsolationWithVertex, tauTagTestVertex}

#    path p2 = {pixelVertices&jetTrackAssociations, coneIsolationWithPxlVertex, tauTagTestPxlVertex}

}
