process TEST = {

    service = DaqMonitorROOTBackEnd{ }

    source = PoolSource {
	untracked vstring fileNames = { 	

'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/003AA8DC-6297-DB11-8E2F-00096BB5DC66.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/008C132E-3C96-DB11-9A17-00E081348D65.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/06A0366D-6497-DB11-99B9-00145E1D645C.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/0ECDACDD-5396-DB11-973B-00C09FD949C0.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/168FA30C-6996-DB11-850F-00145E1D653A.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/16C8BCB4-9097-DB11-8A10-005045010E72.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/16D733D8-5196-DB11-BA24-00E0812040EA.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/18667F8E-6397-DB11-8185-00145E1D6258.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/1A84B082-4296-DB11-9FE7-0030487277C0.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/1EF53A0C-6996-DB11-9ACF-00096BB5DC66.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/20954065-6D96-DB11-928A-00C09FD949C8.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/245CE54E-3C96-DB11-94C4-00E081308783.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/2688D183-6497-DB11-AE87-00096BB5AE4A.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/26A303FA-6497-DB11-B534-00096BB5DC66.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/286E96DD-5E96-DB11-A155-00096BB5B9EA.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/2A2711CE-3896-DB11-8018-00E081308783.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/2A654BB2-5E96-DB11-B210-00145E1DA23A.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/2C07D6F6-4096-DB11-867A-00E081348C8F.root',
'rfio:/castor/cern.ch/cms/store/mc/2006/12/21/mc-physval-120-DiTaus-Pt20To420/0000/321CFB5A-4296-DB11-B36B-0030487247B2.root'

#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/C06D5584-D2B6-DB11-BB04-003048772680.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/362F4C8D-D2B6-DB11-AEC6-0030487726DE.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/96565589-D2B6-DB11-8471-003048779862.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/EA3DD7FC-D8B6-DB11-8D46-003048772680.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/40E7EE60-DBB6-DB11-99A5-0030487624C6.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/6EEDEE99-D2B6-DB11-96B5-0030487624C6.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/006DA335-DAB6-DB11-BC52-00304877970A.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/2AF33AF7-DAB6-DB11-BE03-003048779862.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/58F88DAE-DEB6-DB11-AA84-003048772680.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/0A90FD2D-D8B6-DB11-A298-0030487624C6.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/7496C766-D8B6-DB11-AC83-00304877970A.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/8E442F09-D9B6-DB11-9B38-003048772680.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/C2A45F48-E4B6-DB11-8806-003048779716.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/FEAB86CD-D1B6-DB11-8832-0030487624C6.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/88778AB6-D5B6-DB11-B194-0030487726DE.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/6C4A32B7-D5B6-DB11-936E-003048779862.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/36BD5119-D6B6-DB11-BBAC-003048779716.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/128834C9-D8B6-DB11-A56C-0030487726DE.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/9273030C-D9B6-DB11-96D5-003048779716.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/A6CBC387-DBB6-DB11-9031-003048772680.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/A29755F3-D4B6-DB11-A8F4-0030487624C6.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/64B48CF5-D5B6-DB11-9912-003048772680.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/FC349BE2-D0B6-DB11-8967-00304877970A.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/383E11BC-D2B6-DB11-895D-003048779716.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/4AA556D2-D5B6-DB11-AB9D-0030487624C6.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/5410BDFB-D0B6-DB11-BEEF-00304877970A.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/B0B2CA19-D4B6-DB11-974C-00304877970A.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/7C86703C-D5B6-DB11-B08D-00304877970A.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/A4ACAF2F-D7B6-DB11-8EAE-00304877970A.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/FAA1F9E8-D8B6-DB11-B7C0-0030487624C6.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/A6453F76-DEB6-DB11-9616-0030487624C6.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/E049BC48-E7B6-DB11-A2DE-003048779716.root',
#'/store/mc/2007/1/24/mc-onsel-120_PU_QCD_pt_80_120-DIGI-RECO-LowLumiPU/0000/FA6B3038-E8B6-DB11-BEFE-003048772680.root'
}
	untracked int32 maxEvents = 10000
	untracked uint32 debugVebosity = 0
	untracked bool   debugFlag     = true
    }
 service = AdaptorConfig {}    
    # Message Logger
    include "FWCore/MessageLogger/data/MessageLogger.cfi"
    replace MessageLogger.cout.threshold = "INFO"

#    include "RecoVertex/PrimaryVertexProducer/data/OfflinePrimaryVerticesFromCTFTracks.cff"
    #Pixel Vertexing

    include "RecoPixelVertexing/PixelVertexFinding/data/PixelVertexes.cfi"
    replace pixelVertices.NTrkMin = 2
    
    
    # Test tracks to jets association
    module jetTrackAssociations = JetTracksAssociator {
	InputTag tracks = ctfWithMaterialTracks
	InputTag jets   = iterativeCone5CaloJets
	double coneSize = 0.5
    }
    module coneIsolationWithPxlVertex = coneIsolationTauJetTags from "RecoTauTag/ConeIsolation/data/coneIsolationTauJetTags.cfi"
    replace coneIsolationWithPxlVertex.JetTrackSrc = "jetTrackAssociations"
    replace coneIsolationWithPxlVertex.vertexSrc = "pixelVertices"
    replace coneIsolationWithPxlVertex.DeltaZetTrackVertex = 0.2
    replace coneIsolationWithPxlVertex.useVertex = true	

    
    module coneIsolationWithVertex = coneIsolationTauJetTags from "RecoTauTag/ConeIsolation/data/coneIsolationTauJetTags.cfi"
    replace coneIsolationWithVertex.JetTrackSrc = "jetTrackAssociations"
    replace coneIsolationWithVertex.DeltaZetTrackVertex = 0.2
    replace coneIsolationWithVertex.useVertex = true	
    
    module coneIsolationWithoutVertex = coneIsolationTauJetTags from "RecoTauTag/ConeIsolation/data/coneIsolationTauJetTags.cfi"
    replace coneIsolationWithoutVertex.JetTrackSrc = "jetTrackAssociations"
    replace coneIsolationWithoutVertex.DeltaZetTrackVertex = 0.2
    replace coneIsolationWithoutVertex.useVertex = false


    module tauTagTestPxlVertex = TauTagVal{
	InputTag JetTagProd = coneIsolationWithPxlVertex
	string OutPutFile = "tautag_PxlVertex.root"
	double SignalCone = 0.07
	double MatchingCone = 0.1
        double IsolationCone = 0.45 
	double MinimumTransverseMomentumLeadingTrack = 6.	
    }

    module tauTagTestVertex = TauTagVal{
	InputTag JetTagProd = coneIsolationWithVertex

	string OutPutFile = "tautag_Vertex.root"
	double SignalCone = 0.07
	double MatchingCone = 0.1
        double IsolationCone = 0.45 
	double MinimumTransverseMomentumLeadingTrack = 6.	
    }
    
    module tauTagTestNoVertex = TauTagVal{
	InputTag JetTagProd = coneIsolationWithoutVertex
	string OutPutFile = "tautag_NoVertex.root"
	double SignalCone = 0.07
	double MatchingCone = 0.1
        double IsolationCone = 0.45 
	double MinimumTransverseMomentumLeadingTrack = 6.	
    }
    
     module ConeIsolationForEffValid = ConeIsolation {	
        string JetTrackSrc = "jetTracksAssociator"
        string vertexSrc = "offlinePrimaryVerticesFromCTFTracks"
        int32 MinimumNumberOfPixelHits = 2
        int32 MinimumNumberOfHits = 8
        double MaximumTransverseImpactParameter = 0.03
        double MinimumTransverseMomentum = 1.
        double MaximumChiSquared = 10
        double MatchingCone = 0.1
        double  SignalCone = 0.45
        double  IsolationCone = 0.45
        double MinimumTransverseMomentumInIsolationRing = 1.
        double MinimumTransverseMomentumLeadingTrack = 6.
        double DeltaZetTrackVertex = 15.
        int32   MaximumNumberOfTracksIsolationRing = 0.
        bool useVertex = false
        #string vertexSrc = "offlinePrimaryVerticesFromCTFTracks"
   }


    module tauTagTestForIsoEffValid = TauTagVal{
	InputTag JetTagProd = ConeIsolationForEffValid	
	string OutPutFile = "tautag_IsoEffValid.root"
	double SignalCone = 0.07
	double MatchingCone = 0.1
        double IsolationCone = 0.45 
	double MinimumTransverseMomentumLeadingTrack = 6.	
    }
module jetCrystalsAssociator = JetCrystalsAssociator {
      InputTag towers = towerMaker
      InputTag jets   = iterativeCone5CaloJets 
      double coneSize = 0.5
    }

    module ecalIsolation = EcalIsolation {
	InputTag JetForFilter = jetCrystalsAssociator
	double SmallCone = 0.13
	double BigCone = 0.4
	double Pisol = 5.0
    }

    module tauTagTestForEMIsoEffValid = TauTagVal_EMIso{
	InputTag JetTagProd = ecalIsolation
	string OutPutFile = "tautag_EMIsoEffValid.root"
    }


 module tauTagTestForIsoEffValid_bkg = TauTagVal_BKG{
	InputTag JetTagProd = ConeIsolationForEffValid	
	string OutPutFile = "tautag_IsoEffValid_bkg.root"
	double SignalCone = 0.07
	double MatchingCone = 0.1
        double IsolationCone = 0.45 
	double MinimumTransverseMomentumLeadingTrack = 6.	
    }

include "HLTrigger/HLTstaging/data/common/CaloTowers.cff"
    include "PhysicsTools/HepMCCandAlgos/data/genParticleCandidates.cfi"
    include "Configuration/Applications/data/reco-application-calorimetry-jetmet-gen.cff"
    replace genCandidates.src = "VtxSmeared"
    #Generator sequence 
    sequence tauGenJet = {genCandidates,genParticleCandidates, iterativeCone5GenJets}

    # module execution
#    path p = {offlinePrimaryVerticesFromCTFTracks&jetTrackAssociations, coneIsolationWithoutVertex, tauTagTestNoVertex  }

#     path p1 = {offlinePrimaryVerticesFromCTFTracks&jetTrackAssociations, coneIsolationWithVertex, tauTagTestVertex}

#      path p2 = {pixelVertices&jetTrackAssociations,coneIsolationWithPxlVertex, tauTagTestPxlVertex}

     # For Isolation Cone Eff Valid	
#     path p3={ConeIsolationForEffValid,tauTagTestForIsoEffValid}
#     path p4={tauGenJet,ConeIsolationForEffValid,tauTagTestForIsoEffValid_bkg}
    path p5={jetCrystalsAssociator,ecalIsolation,tauTagTestForEMIsoEffValid}
}
